"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const del_1 = __importDefault(require("del"));
const makeDir = require("make-dir");
const maybeSetupRepo_1 = require("./maybeSetupRepo");
describe('maybeSetupRepo', () => {
    it('should delete repo if an error occurs', async () => {
        expect.assertions(2);
        makeDir.mockImplementationOnce(() => {
            throw new Error('makeDir failed');
        });
        await expect(maybeSetupRepo_1.maybeSetupRepo({
            repoOwner: 'elastic',
            repoName: 'kibana',
            username: 'sqren',
            accessToken: 'myAccessToken',
            gitHostname: 'github.com',
        })).rejects.toThrowError('makeDir failed');
        expect(del_1.default).toHaveBeenCalledWith('/myHomeDir/.backport/repositories/elastic/kibana');
    });
});
